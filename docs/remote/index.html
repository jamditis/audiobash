<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#050505">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/css/xterm.css">
  <link rel="stylesheet" href="css/styles.css">
  <title>AudioBash Remote</title>
</head>
<body>
  <div id="app">
    <!-- Connection Screen -->
    <div id="connect-screen" class="screen active">
      <div class="connect-header">
        <div class="logo">
          <div class="logo-icon"></div>
          <span>AudioBash Remote</span>
        </div>
        <div class="subtitle">Voice control for your desktop terminal</div>
      </div>

      <div class="connect-form">
        <div class="input-group">
          <label for="ip-input">IP address or tunnel URL</label>
          <input
            type="text"
            id="ip-input"
            placeholder="192.168.1.x or xxx.tunnelto.dev"
            inputmode="url"
            autocomplete="off"
          >
        </div>

        <div class="input-group">
          <label for="code-input">Pairing code or password</label>
          <input
            type="text"
            id="code-input"
            placeholder="A3F7X2"
            maxlength="32"
            inputmode="text"
            autocapitalize="characters"
            autocomplete="off"
            style="text-transform: uppercase; letter-spacing: 0.2em; text-align: center; font-size: 1.25rem;"
          >
        </div>

        <button id="connect-btn" class="btn-primary">
          <span class="btn-text">Connect</span>
          <span class="btn-spinner" hidden></span>
        </button>

        <div id="connect-error" class="error"></div>
      </div>

      <div class="connect-help">
        <p>Find connection details in AudioBash Settings &gt; Remote Control</p>
      </div>
    </div>

    <!-- Terminal Screen -->
    <div id="terminal-screen" class="screen">
      <div id="status-bar">
        <div class="status-left">
          <span id="connection-indicator" class="indicator connected"></span>
          <span id="connection-status">Connected</span>
        </div>
        <div class="status-center">
          <select id="tab-selector">
            <option value="tab-1">Terminal 1</option>
          </select>
        </div>
        <div class="status-right">
          <button id="disconnect-btn" class="btn-icon" title="Disconnect">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>

      <div id="terminal-container"></div>

      <div id="voice-controls">
        <div id="mode-toggle">
          <button id="mode-agent" class="mode-btn active">Agent</button>
          <button id="mode-raw" class="mode-btn">Raw</button>
        </div>

        <button id="voice-btn" class="voice-button">
          <svg id="mic-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
            <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
          </svg>
          <svg id="stop-icon" viewBox="0 0 24 24" fill="currentColor" hidden>
            <rect x="6" y="6" width="12" height="12" rx="2"/>
          </svg>
        </button>

        <div id="voice-status">Tap to speak</div>
        <div id="transcription-preview"></div>
      </div>
    </div>

    <!-- Reconnecting Overlay -->
    <div id="reconnect-overlay" class="overlay" hidden>
      <div class="overlay-content">
        <div class="spinner"></div>
        <div class="overlay-text">Reconnecting...</div>
        <button id="cancel-reconnect" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/lib/xterm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0.10.0/lib/addon-fit.min.js"></script>
  <script type="module" src="js/app.js"></script>
</body>
</html>
